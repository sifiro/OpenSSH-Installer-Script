#!/bin/bash
#############################################################################################
#																							#
#	Autor: Sifiro		  			   														#
#   Version: 1.0				  			   												#
#   Licencia: GPL 3.0																		#
#   Codigo Fuente: https://github.com/sifiro/OpenSSH-Installer-Script 						#
#																							#
#############################################################################################
#############################################################################################
#																							#
# Check - Libreria de Control de Ficheros, Integracion y Deteccion de la Diestro GNU/Linux 	#
#																							# 
# Su Resultado es un Array llamado check_status de longitud 6 elementos					   	#				
# Defecto: -1 0 0 0 0 0																		#
# El Primer Elemento identifica el Sistema Operativo										#
# -1 = No Compatible # 0 = Gentoo # 1= Ubuntu # 2=Debian									#
# los demas elementos son la disponibilidad de los ficheros representado por				#
# 0 = No Disponible # 1 = Disponible 														#
#																							#
#############################################################################################
function check () {
## Variables Iniciales
names=("menu" "instal" "configure" "files" "uninstall" "lib")
files_sha256=(a15c4c6392c6d296771f6aa97c87e0534aea26aa8bb7d91eaa212b956a2ca397 2bc135832b7b87e0216495bd8b5d000fe11e0cfb916339e0442eca5f42c1eeac 07e0f4e8d2994a02f9d9cc5c93ea9360976a956a6ae226d20a340dca7629fda3 c803aba8f27f1432f5bdf29d0f3c98ce378bedc9496140a8bf0735105cd28926 779f41b691d662f24fde28022234834aca702e17ab11272e4f46a6c4e32149c2 1019536e4f6d13457abc03608e48217a4614422f8c112d92300ab895d936c707)
# 0 -- Diestro Compatible 1-5 Check de Ficheros
# El Primer elemento del Array indica el Sistema operativo compatible que se usara y apartir de ahi su gestor de paquetes
check_status=(-1 0 0 0 0 0);
support_dist=("Gentoo" "Ubuntu" "Debian");
echo "Chequeando Sistema Operativo"
linux=`lsb_release -i | cut -f2`
sleep 1
echo "Sistema Operativo Seleccionando: $linux"
echo "Comprobando Compatibilidad con el Script"
sleep 1
for((i=0;i<${#support_dist[*]};++i))
	do
		if [ "$linux" = "${support_dist[i]}" ];then 
			check_status[0]=$i
			echo "Sistema Operativo Compatible"
			break
		fi
done

for((i=0;i<${#names[*]};++i))
	do
	directory=files/${names[i]}
	echo -n Chequeando ${names[i]}
			if [ -f $directory ] ;then 
				echo -n ".";
				sleep 1
				echo -n ".";
				if [ "${files_sha256[i]}" = "`sha256sum $directory| cut -d' ' -f1`" ];then
					sleep 1
					check_status[`expr $i + 1`]=1
					echo -e ". ${GREEN}OK${NORM}";
					else 
						echo -e "  ${RED}FAIL"
						echo -e "ERROR,PROBLEMAS CON LA INTEGRACION DEL FICHERO${NORM}"
				fi
				else 
				echo -e "  ${RED}FAIL"
				echo -e " ERROR, FICHERO NO EXISTENTE${NORM}"
			fi
	done
}
